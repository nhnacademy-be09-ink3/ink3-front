<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ink3 - 쿠폰 정책 목록</title>

    <!-- Google Fonts: Inter -->
    <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
            rel="stylesheet"
    />

    <!-- Tailwind CSS (빌드 환경에서 @apply가 처리된 output.css) -->
    <link
            rel="stylesheet"
            th:href="@{/css/output.css(v=${#dates.createNow().getTime()})}"
    />

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-100">
<!-- ─────────────────────────────────────────────────────────────
     헤더 (공통 프래그먼트)
     ───────────────────────────────────────────────────────────── -->
<div th:replace="~{admin/layout/fragments/header :: headerFragment}"></div>

<div class="flex flex-1 min-h-[calc(100vh-64px)]">
    <!-- ─────────────────────────────────────────────────────────────
         사이드바 (공통 프래그먼트)
         ───────────────────────────────────────────────────────────── -->
    <div th:replace="~{admin/layout/fragments/sidebar :: sidebarFragment}"></div>

    <!-- ─────────────────────────────────────────────────────────────
         메인 콘텐츠 영역
         ───────────────────────────────────────────────────────────── -->
    <main class="main-content-area flex-1 p-6 bg-gray-100 overflow-y-auto">

        <!-- ─────────────────────────────────────────────────────────
             “출판사 관리” 화면과 동일한 카드 컨테이너 구조를 사용
             ───────────────────────────────────────────────────────── -->
        <div class="w-8/12 mx-auto flex flex-col space-y-6">
            <div class="w-3/4 flex flex-col space-y-4">
                <div class="ink-card-white p-6">
                    <!-- 카드 상단 제목 -->
                    <h1 class="text-xl font-semibold text-gray-800 mb-6">
                        쿠폰 정책 목록
                    </h1>
                    <form th:action="@{/admin/policies}"
                          method="get"
                          class="flex items-center space-x-2 mb-6">
                        <input
                                type="number"
                                name="policyId"
                                placeholder="정책 ID"
                                required
                                class="ink-input-field w-full max-w-xs"
                        />
                        <button type="submit" class="ink-btn-primary">
                            조회
                        </button>
                    </form>


                    <!-- ─────────────────────────────────────────────────────
                         테이블 헤더: 총 6개 컬럼 (순번/이름/할인 유형/할인 금액/할인률/생성 일자)
                         ───────────────────────────────────────────────────── -->
                    <table class="min-w-full bg-white rounded-lg overflow-hidden">
                        <thead class="bg-gray-100 border-b border-gray-200">
                        <tr>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider rounded-tl-lg"
                            >
                                순번
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                            >
                                이름
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                            >
                                최소 주문 금액
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                            >
                                할인 유형
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                            >
                                할인 금액
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                            >
                                할인률
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider"
                            >
                                최대 할인 금액
                            </th>
                            <th
                                    class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider rounded-tr-lg"
                            >
                                생성 일자
                            </th>
                        </tr>
                        </thead>

                        <tbody class="divide-y divide-gray-200">
                        <!--
                          th:each 로 policies.content(=List<PolicyResponse>)를 꺼내서 반복.
                          stat.count 는 1-based 인덱스(=순번)으로 사용할 수 있음.
                        -->
                        <tr
                                class="hover:bg-gray-50 transition-colors duration-200"
                                th:each="policy, stat : ${policies.content}"
                        >
                            <!-- 순번 (1-based) -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${stat.count}">
                                1
                            </td>
                            <!-- 정책 이름 -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${policy.policyName}">
                                SPRING_SALE2025
                            </td>
                            <!-- 최소 주문 금액 -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${policy.minimumOrderAmount}">
                                10000
                            </td>
                            <!-- 할인 유형 (RATE or FIXED) -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${policy.discountType}">
                                RATE
                            </td>
                            <!-- 정액 할인 금액 (FIXED인 경우 맞고, RATE인 경우 0 또는 비워둘 수 있음) -->
                            <td class="py-3 px-4 text-sm text-gray-700"
                                th:text="${policy.discountValue} ?: '0'">0</td>
                            <!-- 정률 할인 % (RATE인 경우 맞고, FIXED인 경우 0 또는 비워둘 수 있음) -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${policy.discountPercentage} ?: '0'">
                                0
                            </td>
                            <!-- 최대 할인 금액 -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${policy.maximum} ?: '0'">
                                0
                            </td>
                            <!-- 생성 일자 -->
                            <td class="py-3 px-4 text-sm text-gray-700" th:text="${policy.createdAt}">
                                2025-06-05T12:00:00
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <!-- ─────────────────────────────────────────────────────
                         페이지네이션 (페이징 네비게이션)
                         ───────────────────────────────────────────────────── -->
                    <ul class="flex justify-center gap-1 text-gray-900 mt-6">
                        <!-- “이전” 화살표 링크 -->
                        <li>
                            <a
                                    th:href="@{/admin/policies( page=${policies.hasPrevious()} ? ${policies.number} - 1 : ${policies.number} )}"
                                    class="ink-page-item-arrow"
                                    aria-label="Previous page"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 20 20" fill="currentColor">
                                    <path
                                            fill-rule="evenodd"
                                            d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                                            clip-rule="evenodd"
                                    />
                                </svg>
                            </a>
                        </li>

                        <!-- 실제 페이지 번호 (예: 1,2,3,4,5 ...) -->
                        <li th:each="i : ${#numbers.sequence(pageInfo.startPage, pageInfo.endPage)}">
                            <a
                                    th:href="@{/admin/policies(page=${i})}"
                                    th:class="${i == policies.number} ? 'ink-page-item-current' : 'ink-page-item'"
                                    th:text="${i + 1}"
                            >
                                1
                            </a>
                        </li>

                        <!-- “다음” 화살표 링크 -->
                        <li>
                            <a
                                    th:href="@{/admin/policies( page=${policies.hasNext()} ? ${policies.number} + 1 : ${policies.number} )}"
                                    class="ink-page-item-arrow"
                                    aria-label="Next page"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 20 20" fill="currentColor">
                                    <path
                                            fill-rule="evenodd"
                                            d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                            clip-rule="evenodd"
                                    />
                                </svg>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- ───────────────────────────────────────────────────────────── -->

    </main>
</div>
</body>
</html>
